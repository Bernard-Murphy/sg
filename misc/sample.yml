service: sg-lambda-functions

frameworkVersion: "3"

provider:
  name: aws
  runtime: nodejs18.x
  endpointType: EDGE
  timeout: 10
  region: us-east-1
  stage: ${opt:stage, 'dev'}
  iam:
    role: arn:aws:iam::142530420275:role/sg-lambda-role
  deploymentBucket:
    skipPolicySetup: true
  apiGateway:
    binaryMediaTypes:
      - "*/*"
  environment:
    DYNAMO_FILES_TABLE: ""
    REGION: ""
    AWS_SECRET_ACCESS_ID: ""
    AWS_SECRET_ACCESS_KEY: ""
    CHROMIUM_TAR_SOURCE: ""
    ASSET_URL: ""
    PDF_FOLDER: ""
    ASSET_BUCKET: ""

plugins:
  - serverless-offline
  - serverless-package-external
  - serverless-prune-versions
  - serverless-plugin-include-dependencies
  - serverless-prune-plugin

package:
  excludeDevDependencies: false

custom:
  serverless-offline:
    lambdaPort: ${opt:lambdaPort}
    httpPort: ${opt:httpPort}
    useInProcess: true

#config
functions:
  auth_get_init:
    handler: handler.auth_get_init
    timeout: 29
    events:
      - http:
          path: auth/init
          method: get
          cors: true
  auth_post_login:
    handler: handler.auth_post_login
    timeout: 29
    events:
      - http:
          path: auth/login
          method: post
          cors: true
  auth_post_register:
    handler: handler.auth_post_register
    timeout: 29
    events:
      - http:
          path: auth/register
          method: post
          cors: true
  auth_get_logout:
    handler: handler.auth_get_logout
    timeout: 29
    events:
      - http:
          path: auth/logout
          method: get
          cors: true
  files_post:
    handler: handler.files_post
    timeout: 29
    events:
      - http:
          path: files
          method: post
          cors: true
  files_patch:
    handler: handler.files_patch
    timeout: 29
    events:
      - http:
          path: files/{patchId}
          method: patch
          cors: true
  files_delete:
    handler: handler.files_delete
    timeout: 29
    events:
      - http:
          path: files/{deleteId}
          method: delete
          cors: true
